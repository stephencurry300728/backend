(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-bbaeb226"],{"26b8":function(e,t,a){},"280b":function(e,t,a){"use strict";a("26b8")},a15b:function(e,t,a){"use strict";var n=a("23e7"),r=a("44ad"),o=a("fc6a"),c=a("a640"),s=[].join,i=r!=Object,l=c("join",",");n({target:"Array",proto:!0,forced:i||!l},{join:function(e){return s.call(o(this),void 0===e?",":e)}})},b2ac:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"upload-container"},[a("el-upload",{staticClass:"upload-demo",attrs:{multiple:!0,"before-upload":e.beforeUpload,"http-request":e.uploadRequest,accept:".csv","show-file-list":!0,drag:"",action:"/upload-assessment/"}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),a("em",[e._v("点击上传")])]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("*只能上传csv文件*")])]),a("el-button",{staticClass:"upload-button",attrs:{type:"primary",icon:"el-icon-folder-opened"},on:{click:e.triggerFileSelect}},[e._v("选择文件上传")]),a("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"fileInput",attrs:{type:"file",accept:".csv, text/csv",multiple:""},on:{change:e.handleUpload}}),a("el-button",{staticClass:"upload-button",attrs:{type:"success",icon:"el-icon-folder"},on:{click:e.triggerFolderSelect}},[e._v("选择文件夹上传")]),a("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"folderInput",attrs:{type:"file",webkitdirectory:""},on:{change:e.handleUpload}})],1)},r=[],o=a("b85c"),c=a("c7eb"),s=a("1da1"),i=(a("99af"),a("a15b"),a("fb6a"),a("b0c0"),a("b775"));function l(e){var t=new FormData;return t.append("file",e),Object(i["a"])({url:"/upload-assessment/",method:"post",data:t,headers:{"Content-Type":"multipart/form-data"}})}var u=a("323e"),p=a.n(u),f=(a("a5d8"),{data:function(){return{isNavigating:!1,confirmShown:!1}},methods:{beforeUpload:function(e){var t="text/csv"===e.type;return!!t||(this.$message.error("只能上传csv文件！"),!1)},uploadRequest:function(e){var t=this;return Object(s["a"])(Object(c["a"])().mark((function a(){var n;return Object(c["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return p.a.start(),n=e.file.name.split(".").slice(0,-1).join("."),a.prev=2,a.next=5,l(e.file);case 5:a.sent,t.$message.success("".concat(n," 文件上传成功！")),t.isNavigating||t.confirmShown||(t.confirmShown=!0,t.$confirm("是否继续上传文件，或是前往设置步骤?","上传成功",{confirmButtonText:"前往设置",cancelButtonText:"继续上传",type:"warning"}).then((function(){t.isNavigating=!0,t.$router.push({path:"/settings"})})).catch((function(){t.confirmShown=!1,window.location.reload()}))),a.next=14;break;case 10:a.prev=10,a.t0=a["catch"](2),console.error("Upload error:",a.t0),t.$message.error("上传失败：".concat(n,"，错误信息：").concat(a.t0.message||"未知错误"));case 14:return a.prev=14,p.a.done(),a.finish(14);case 17:case"end":return a.stop()}}),a,null,[[2,10,14,17]])})))()},resetInput:function(e){e&&e.value&&(e.value="")},triggerFileSelect:function(){this.$refs.fileInput.click()},triggerFolderSelect:function(){this.$refs.folderInput.click()},handleUpload:function(e){var t=this;return Object(s["a"])(Object(c["a"])().mark((function a(){var n,r,s,i;return Object(c["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.confirmShown=!1,n=e.target.files,r=Object(o["a"])(n),a.prev=3,r.s();case 5:if((s=r.n()).done){a.next=18;break}return i=s.value,a.prev=7,console.log("Uploading:",i.name),a.next=11,t.uploadRequest({file:i});case 11:a.next=16;break;case 13:a.prev=13,a.t0=a["catch"](7),console.error("Error uploading ".concat(i.name,":"),a.t0);case 16:a.next=5;break;case 18:a.next=23;break;case 20:a.prev=20,a.t1=a["catch"](3),r.e(a.t1);case 23:return a.prev=23,r.f(),a.finish(23);case 26:t.resetInput(e.target);case 27:case"end":return a.stop()}}),a,null,[[3,20,23,26],[7,13]])})))()},beforeRouteLeave:function(e,t,a){this.isNavigating=!1,this.confirmShown=!1,a()}}}),d=f,v=(a("280b"),a("2877")),h=Object(v["a"])(d,n,r,!1,null,"03b9df0e",null);t["default"]=h.exports}}]);