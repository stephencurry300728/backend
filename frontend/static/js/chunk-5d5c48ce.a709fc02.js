(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5d5c48ce"],{"11c8":function(t,e,a){},9406:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"dashboard-container"},[0===t.allTrainingData.length?a("div",{staticClass:"no-data-info"},[a("p",[t._v(" 无数据，请"),a("a",{attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.goToUploadPage.apply(null,arguments)}}},[t._v("点击这里")]),t._v("上传。 ")])]):a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-card",[a("div",{staticStyle:{height:"340px"},attrs:{id:"pie-chart"}})])],1),a("el-col",{attrs:{span:12}},[a("el-card",[a("el-select",{attrs:{placeholder:"请选择线路"},on:{change:t.onLineChange},model:{value:t.selectedLine,callback:function(e){t.selectedLine=e},expression:"selectedLine"}},t._l(t.lineOptions,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1),a("div",{staticStyle:{height:"300px"},attrs:{id:"bar-chart"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-card",{staticStyle:{"margin-top":"20px"}},[a("div",{staticStyle:{height:"380px"},attrs:{id:"barplot-chart"}})])],1)],1)],1)},r=[],i=a("5530"),s=a("c7eb"),c=a("1da1"),o=(a("4de4"),a("a630"),a("d81d"),a("13d5"),a("4e82"),a("b64b"),a("d3b7"),a("07ac"),a("6062"),a("3ca3"),a("159b"),a("ddb0"),a("ad8f")),l=a("313e"),u={name:"Dashboard",data:function(){return{allTrainingData:[],selectedLine:"09"}},created:function(){this.getAllTrainingData()},watch:{selectedLine:function(t,e){this.lineOptions.some((function(e){return e.value===t}))?this.initBarChart():this.selectedLine=e}},computed:{lineOptions:function(){if(this.allTrainingData&&this.allTrainingData.length>0){var t=new Set(this.allTrainingData.map((function(t){return t.train_model.substring(0,2)}))),e=Array.from(t).map((function(t){return{label:"".concat(t,"号线"),value:t}}));return e}return[]}},methods:{getAllTrainingData:function(){var t=this;return Object(c["a"])(Object(s["a"])().mark((function e(){var a;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(o["a"])();case 2:a=e.sent,t.allTrainingData=a.data,t.$nextTick((function(){t.initPieChart(),t.initBarChart(),t.initBarplotChart()}));case 5:case"end":return e.stop()}}),e)})))()},goToUploadPage:function(){this.$router.push("/upload")},processPieChartData:function(){var t=this,e={};return this.allTrainingData.forEach((function(t){var a=t.assessment_item,n=t.assessment_result;e[a]||(e[a]={1:0,2:0,3:0}),e[a][n]++})),Object.keys(e).map((function(a){return{name:a,type:"pie",data:Object.keys(e[a]).map((function(n){return{value:e[a][n],name:t.resultName(n)}}))}}))},resultName:function(t){var e={1:"不合格",2:"合格",3:"优秀"};return e[t]},initPieChart:function(){var t=l["a"](document.getElementById("pie-chart")),e={title:{text:"考核结果饼状图",left:"center",textStyle:{fontSize:20}},tooltip:{trigger:"item"},legend:{orient:"vertical",left:"left"},series:[Object(i["a"])(Object(i["a"])({},this.processPieChartData()[0]),{},{center:["50%","60%"],itemStyle:{color:function(t){var e=["#5470C6","#91CC75","#EE6666"];return e[t.dataIndex%e.length]}}})]};t.setOption(e)},processBarChartData:function(){var t=this,e=this.allTrainingData.filter((function(e){var a=e.train_model;return a.substring(0,2)===t.selectedLine})),a={};e.forEach((function(t){var e=t.crew_group,n=t.assessment_result;a[e]||(a[e]={1:0,2:0,3:0}),a[e][n]++}));var n=Object.keys(a).map((function(t){return{group:t,total:Object.values(a[t]).reduce((function(t,e){return t+e}),0)}})).sort((function(t,e){return e.total-t.total})).map((function(t){return t.group})),r=["1","2","3"].map((function(e){return{name:t.resultName(e),type:"bar",stack:"总量",data:n.map((function(t){return a[t][e]}))}}));return{series:r,categories:n}},initBarChart:function(){var t=this.processBarChartData(),e=t.series,a=t.categories,n=l["a"](document.getElementById("bar-chart")),r={title:{text:"各乘务班组考核结果",left:"center",textStyle:{fontSize:20}},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{data:["不合格","合格","优秀"],left:"right",orient:"vertical"},xAxis:{type:"category",data:a,axisLabel:{interval:0,rotate:45}},yAxis:{type:"value"},color:["#EE6666","#91CC75","#5470C6"],series:e};n.setOption(r,!0)},onLineChange:function(){this.initBarChart()},processBarplotData:function(){var t=this.allTrainingData.reduce((function(t,e){var a=e.train_model.substring(0,2),n=e.assessment_result;return t[a]||(t[a]={"不合格":0,"合格":0,"优秀":0}),1===n?t[a]["不合格"]++:2===n?t[a]["合格"]++:3===n&&t[a]["优秀"]++,t}),{}),e=["不合格","合格","优秀"],a=e.map((function(e){return{name:e,type:"bar",barWidth:"50%",data:Object.keys(t).map((function(a){return t[a][e]})),stack:"总分"}}));return{seriesData:a,categories:Object.keys(t).map((function(t){return"线路".concat(t)}))}},initBarplotChart:function(){var t=this.processBarplotData(),e=t.seriesData,a=t.categories,n=l["a"](document.getElementById("barplot-chart")),r={title:{text:"各线路考核结果",left:"center",textStyle:{fontSize:20}},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{data:["不合格","合格","优秀"],left:"left"},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"value"},yAxis:{type:"category",data:a},color:["#EE6666","#91CC75","#5470C6"],series:e};n.setOption(r)}}},d=u,f=(a("cebb"),a("2877")),p=Object(f["a"])(d,n,r,!1,null,"66c38da2",null);e["default"]=p.exports},ad8f:function(t,e,a){"use strict";a.d(e,"e",(function(){return r})),a.d(e,"d",(function(){return i})),a.d(e,"f",(function(){return s})),a.d(e,"b",(function(){return c})),a.d(e,"c",(function(){return o})),a.d(e,"a",(function(){return l}));var n=a("b775");function r(t){return Object(n["a"])({url:"/assessment-base/",method:"get",params:t})}function i(t){return Object(n["a"])({url:"/assessment-base/".concat(t,"/"),method:"get"})}function s(t,e){return Object(n["a"])({url:"/assessment-base/".concat(t,"/"),method:"patch",data:e})}function c(t){return Object(n["a"])({url:"/assessment-base/".concat(t,"/"),method:"delete"})}function o(){return Object(n["a"])({url:"/assessment-base/all-train-and-assessment/",method:"get"})}function l(t){return Object(n["a"])({url:"/assessment-base/unpaged-data/",method:"get",params:t})}},cebb:function(t,e,a){"use strict";a("11c8")}}]);